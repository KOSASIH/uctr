-- vuln_database.db

-- Table: vulnerabilities
CREATE TABLE vulnerabilities (
  id INTEGER PRIMARY KEY,
  cve_id TEXT NOT NULL,
  vulnerability_name TEXT NOT NULL,
  description TEXT NOT NULL,
  severity REAL NOT NULL,
  cvss_score REAL NOT NULL,
  published_date DATE NOT NULL,
  last_updated_date DATE NOT NULL,
  vulnerability_type TEXT NOT NULL,
  affected_software TEXT NOT NULL,
  affected_versions TEXT NOT NULL,
  references TEXT NOT NULL
);

-- Table: vulnerability_exploits
CREATE TABLE vulnerability_exploits (
  id INTEGER PRIMARY KEY,
  vulnerability_id INTEGER NOT NULL,
  exploit_code TEXT NOT NULL,
  exploit_type TEXT NOT NULL,
  exploit_description TEXT NOT NULL,
  exploit_date DATE NOT NULL,
  FOREIGN KEY (vulnerability_id) REFERENCES vulnerabilities(id)
);

-- Table: vulnerability_patches
CREATE TABLE vulnerability_patches (
  id INTEGER PRIMARY KEY,
  vulnerability_id INTEGER NOT NULL,
  patch_name TEXT NOT NULL,
  patch_description TEXT NOT NULL,
  patch_date DATE NOT NULL,
  patch_url TEXT NOT NULL,
  FOREIGN KEY (vulnerability_id) REFERENCES vulnerabilities(id)
);

-- Table: vulnerability_references
CREATE TABLE vulnerability_references (
  id INTEGER PRIMARY KEY,
  vulnerability_id INTEGER NOT NULL,
  reference_url TEXT NOT NULL,
  reference_description TEXT NOT NULL,
  FOREIGN KEY (vulnerability_id) REFERENCES vulnerabilities(id)
);

-- Index: idx_vulnerabilities_cve_id
CREATE INDEX idx_vulnerabilities_cve_id ON vulnerabilities (cve_id);

-- Index: idx_vulnerability_exploits_vulnerability_id
CREATE INDEX idx_vulnerability_exploits_vulnerability_id ON vulnerability_exploits (vulnerability_id);

-- Index: idx_vulnerability_patches_vulnerability_id
CREATE INDEX idx_vulnerability_patches_vulnerability_id ON vulnerability_patches (vulnerability_id);

-- Index: idx_vulnerability_references_vulnerability_id
CREATE INDEX idx_vulnerability_references_vulnerability_id ON vulnerability_references (vulnerability_id);
